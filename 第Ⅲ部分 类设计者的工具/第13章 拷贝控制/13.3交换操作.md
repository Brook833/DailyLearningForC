# 13.3 交换操作
除了定义拷贝控制成员，管理资源的类通常还定义一个名为swap的函数。对于那些与重排元素顺序的算法一起使用的类，定义swap时非常重要的。这类算法在需要交换两个元素时会调用swap。

如果一个类定义了自己的swap，那么算法将使用类自定义版本。否则，算法将使用标准库定义的swap。虽然与往常一样我们不知道swap是如何实现的，但理论上很容易理解，为了交换两个对象我们需要进行一次拷贝和两次赋值。例如，交换两个类值HasPtr对象的代码可能像下面这样:

```c++
HasPtr temp = v1;  // 创建v1的值的一个临时副本
v1 = v2;  // 将v2的值赋予v1
v2 = temp;  // 将保存的v1的值赋予v2
```

这段代码将原来v1中的string拷贝了两次————第一次拷贝是HasPtr的拷贝构造函数将v1拷贝给temp，第二次是赋值运算符将temp赋予v2。将v2赋予v1的语句还拷贝了元来v2中的string。如果我们所见，拷贝一个类值的HasPtr会分配一个新string并将其拷贝到HasPtr指向的位置。

理论上，这些内存分配都是不必要的。我们更希望swap交换指针，而不是分配string的新副本。即，我们希望这样交换两个HasPtr:

```c++
string *temp = v1.ps;  // 为v1.ps中的指针创建一个副本
v1.ps = v2.ps;  // 为v2.ps中的指针赋予v1.ps
v2.ps = temp;  // 将保存的v1.ps中原来的指针赋予v2.ps
```