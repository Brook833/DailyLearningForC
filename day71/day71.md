2022.11.27



## 10.3.3 lambda捕获和返回
当定义一个lambda时，编译器生成一个与lambda对应的新的(未命名的)类类型。我们将在14.9.1节介绍这种类是如何生成的，目前，可以这样理解，当向一个函数传递一个lambda时，同时定义了一个新类型和该类型的一个对象:传递的参数就是此编译器生成的类类型的未命名对象。类似的，当使用auto定义一个用lambda初始化变量时，定义了一个从lambda生成的类型的对象。

默认情况下，从lambda生成的类都包含一个对应该lambda所捕获的变量的数据成员。类似任何普通类的数据成员，lambda的数据成员也在lambda对象创建时被初始化。

### 值捕获
类似参数传递，变量的捕获方式也可以是值或引用。表10.1列出了集中不同的构造捕获列表的方式。到目前为止，我们的lambda采用值捕获的方式。与传值参数类似，采用值捕获的前提是变量可以拷贝。与参数不同，被捕获的变量的值是在lambda创建时拷贝，而不是调用时拷贝:

```c++
void fcn1() {
    size_t v1 = 42;  // 局部变量
    auto f = [v1]{ return v1; };  // 将v1拷贝到名为f的可调用对象
    v1 = 0;
    auto j = f();  // j为42；f保存了我们创建它时v1的拷贝。
}
```

由于被捕获变量的值实在lambda创建时拷贝，因此随后对其修改不会影响到lambda内对应的值。

